
<!DOCTYPE html>
<html lang="" class="loading">
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>廖锡洪</title>

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate">
    <meta name="keywords" content="viabcde,"> 
    
    <meta name="author" content="viacbde"> 
    <link rel="alternative" href="atom.xml" title="廖锡洪" type="application/atom+xml"> 
    <link rel="icon" href="/img/favicon.png"> 
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
    <link rel="stylesheet" href="/css/diaspora.css">
</head>
</html>
<body class="loading">
    <div id="loader"></div>
    <div id="single">
    <div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <a class="icon-home image-icon" href="javascript:;"></a>
    <div title="播放/暂停" class="icon-play"></div>
    <h3 class="subtitle">Oracle2</h3>
    <div class="social">
        <!--<div class="like-icon">-->
            <!--<a href="javascript:;" class="likeThis active"><span class="icon-like"></span><span class="count">76</span></a>-->
        <!--</div>-->
        <div>
            <div class="share">
                <a title="获取二维码" class="icon-scan" href="javascript:;"></a>
            </div>
            <div id="qr"></div>
        </div>
    </div>
    <div class="scrollbar"></div>
</div>
    <div class="section">
        <div class="article">
    <div class="main">
        <h1 class="title">Oracle2</h1>
        <div class="stuff">
            <span>十二月 19, 2018</span>
            
  <ul class="post-tags-list"><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/数据库/">数据库</a><span class="post-tags-list-count">6</span></li><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/标签/">标签</a><span class="post-tags-list-count">162</span></li></ul>


        </div>
        <div class="content markdown">
            <h3 id="创建用户"><a href="#创建用户" class="headerlink" title="创建用户"></a><strong>创建用户</strong></h3><p>具有dba(数据库管理员)的权限才能使用<br>create user 用户名 identified by 密码;<br>eg、<code>create user xiaoming identified by oracle;</code><br><strong>可能遇到的bug：</strong>oracle有个毛病，密码必须以字母开头，如果以数字开头，它不会创建用户   </p>
<h3 id="修改用户的密码"><a href="#修改用户的密码" class="headerlink" title="修改用户的密码"></a><strong>修改用户的密码</strong></h3><p>一是修改自己的密码，可直接修改：SQL&gt; <code>password 用户名</code>   或者直接敲  <code>passw</code><br>二是给别人修改密码则需要具有dba的权限，或是拥有alter user的系统权限   <code>SQL&gt; alter user 用户名 identified by 新密码</code>   </p>
<h3 id="删除用户"><a href="#删除用户" class="headerlink" title="删除用户"></a><strong>删除用户</strong></h3><p><strong>前提：</strong>一般以dba的身份去删除某个用户，如果用其它用户去删除用户则需要具有drop user的权限<br>drop user 用户名 cascade<br><strong>加cascade的原因：</strong>在删除用户时，如果要删除的用户，已经创建了表，那么就需要在删除的时候带一个参数cascade，即把该用户及表一同删除;   </p>
<h3 id="权限"><a href="#权限" class="headerlink" title="权限"></a><strong>权限</strong></h3><p>权限分为系统权限和对象权限<br>何为系统权限？<br>用户对数据库的相关权限，connect、resource、dba等系统权限，如建库、建表、建索引、建存储过程、登陆数据库、修改密码等。<br>何为对象权限？<br>用户对其他用户的数据对象操作的权限，insert、delete、update、select、all等对象权限，数据对象有很多，比如表，索引，视图，触发器、存储过程、包等。</p>
<h3 id="角色"><a href="#角色" class="headerlink" title="角色"></a><strong>角色</strong></h3><p>角色分为预定义角色和自定义角色    </p>
<h2 id="预定义角色connect、resource、dba"><a href="#预定义角色connect、resource、dba" class="headerlink" title="预定义角色connect、resource、dba"></a><strong>预定义角色connect、resource、dba</strong></h2><p><strong>connect角色</strong>   ：开发人员需要的大部分权限   </p>
<figure class="highlight plain"><figcaption><span>cluster</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">create database link</span><br><span class="line">create session</span><br><span class="line">alter session</span><br><span class="line">create table</span><br><span class="line">create view</span><br><span class="line">create sequence</span><br></pre></td></tr></table></figure>
<p><strong>resource角色</strong>：具有应用开发人员所需要的其它权限，比如建立存储过程，触发器等    </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">create cluster</span><br><span class="line">create indextype</span><br><span class="line">create table</span><br><span class="line">create sequence</span><br><span class="line">create type</span><br><span class="line">create procedure</span><br><span class="line">create trigger</span><br></pre></td></tr></table></figure>
<p><strong>dba角色</strong><br>dba角色具有所有的系统权限，及with admin option选项，默认的dba用户为sys和system，它们可以将任何系统权限授予其他用户。但是要注意的是dba角色不具备sysdba和sysoper的特权（启动和关闭数据库）   </p>
<h2 id="自定义角色"><a href="#自定义角色" class="headerlink" title="自定义角色"></a><strong>自定义角色</strong></h2><p>一般是dba来建立，如果用别的用户来建立，则需要具有create role的系统权限。<br><strong>建立角色（不验证）</strong>：<code>create role 角色名 not identified;</code><br><strong>建立角色（数据库验证）</strong>：<code>create role 角色名 identified by 密码;</code></p>
<h2 id="给角色授权"><a href="#给角色授权" class="headerlink" title="给角色授权"></a><strong>给角色授权</strong></h2><figure class="highlight plain"><figcaption><span>conn system/oracle;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; grant create session to 角色名 with admin option</span><br><span class="line">SQL&gt; conn scott/oracle@orcl;</span><br><span class="line">SQL&gt; grant select on scott.emp to 角色名;</span><br><span class="line">SQL&gt; grant insert, update, delete on scott.emp to 角色名;</span><br></pre></td></tr></table></figure>
<p><strong>注意：</strong>系统权限的unlimited tablespace和对象权限的with grant option选项是不能授予角色的   </p>
<h2 id="分配角色给某个用户"><a href="#分配角色给某个用户" class="headerlink" title="分配角色给某个用户"></a><strong>分配角色给某个用户</strong></h2><p>一般分配角色是由dba来完成的，如果要以其它用户身份分配角色，则要求用户必须具有grant any role的系统权限。<br><figure class="highlight plain"><figcaption><span>conn system/oracle;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; grant 角色名 to blake with admin option;</span><br></pre></td></tr></table></figure></p>
<h2 id="删除角色"><a href="#删除角色" class="headerlink" title="删除角色"></a><strong>删除角色</strong></h2><p>一般是dba来执行，如果其它用户则要求该用户具有drop any role系统权限<br><figure class="highlight plain"><figcaption><span>conn system/oracle;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; drop role 角色名;</span><br></pre></td></tr></table></figure></p>
<p><strong>bug:</strong> 如果角色被删除，那么被授予角色的用户不具有之前角色里的权限</p>
<h2 id="显示角色信息"><a href="#显示角色信息" class="headerlink" title="显示角色信息"></a><strong>显示角色信息</strong></h2><p><strong>显示所有角色：</strong> <code>SQL&gt; select * from dba_roles;</code><br><strong>显示角色具有的系统权限</strong>：<code>SQL&gt; select privilege, admin_option from role_sys_privs where role=&#39;角色名&#39;;</code></p>
<h3 id="用户管理案例"><a href="#用户管理案例" class="headerlink" title="用户管理案例"></a><strong>用户管理案例</strong></h3><p>概述：创建的新用户是没有任何权限的，甚至连登陆的数据库的权限都没有，需要为其指定相应的权限。给一个用户赋权限使用命令grant，回收权限使用命令revoke。<br>为了讲清楚用户的管理，这里我给大家举一个案例。<br>SQL&gt; conn xiaoming/oracle<br>ERROR:<br>ORA-01045: user XIAOMING lacks CREATE SESSION privilege; logon denied<br>警告: 您不再连接到 ORACLE。<br>SQL&gt; show user<br>USER 为 “”<br>SQL&gt; conn system/oracle<br>已连接。<br>SQL&gt; grant connect to xiaoming;<br>授权成功。<br>SQL&gt; conn xiaoming/oracle<br>已连接。<br>SQL&gt;<br>注意：grant connect to xiaoming;在这里，准确的讲，connect不是权限，而是角色。   </p>
<p>现在说下对象权限，现在要做这么件事情：<br> 希望xiaoming用户可以去查询emp表<br> 希望xiaoming用户可以去查询scott的emp表<br>grant select on scott.emp to xiaoming<br> 希望xiaoming用户可以去修改scott的emp表<br>grant update on scott.emp to xiaoming<br> 希望xiaoming 用户可以去修改/删除，查询，添加scott的emp表<br>grant all on scott.emp to xiaoming<br> scott希望收回xiaoming对emp表的查询权限<br>revoke select on scott.emp from xiaoming   </p>
<h3 id="with-admin-option与with-grant-option区别"><a href="#with-admin-option与with-grant-option区别" class="headerlink" title="with admin option与with grant option区别"></a><strong>with admin option与with grant option区别</strong></h3><p>1、with admin option用于系统权限授权，with grant option用于对象授权。<br>2、给一个用户授予系统权限带上with admin option时，此用户可把此系统权限授予其他用户或角色，但收回这个用户的系统权限时，这个用户已经授予其他用户或角色的此系统权限不会因传播无效，如授予A系统权限create session with admin option,然后A又把create session权限授予B,但管理员收回A的create session权限时，B依然拥有create session的权限，但管理员可以显式收回B create session的权限，即直接revoke create session from B.<br>而with grant option用于对象授权时，被授予的用户也可把此对象权限授予其他用户或角色，不同的是但管理员收回用with grant option授权的用户对象权限时，权限会因传播而失效，如grant select on table with grant option to A,A用户把此权限授予B，但管理员收回A的权限时，B的权限也会失效，但管理员不可以直接收回B的SELECT ON TABLE 权限。   </p>
<h3 id="账户锁定"><a href="#账户锁定" class="headerlink" title="账户锁定"></a><strong>账户锁定</strong></h3><p>指定scott这个用户最多只能尝试3次登陆，锁定时间为2天<br>创建profile文件<br>SQL&gt; create profile lock_account limit failed_login_attempts 3 password_lock_time 2;<br>SQL&gt; alter user scott profile lock_account;<br>给账户(用户)解锁<br>SQL&gt; alter user scott account unlock<br>终止口令:给前面创建的用户test创建一个profile文件，要求该用户每隔10天要修改自己的登陆密码，宽限期为2天。<br>SQL&gt; create profile myprofile limit password_life_time 10 password_grace_time 2;<br>SQL&gt; alter user test profile myprofile;<br>口令历史:希望用户在修改密码时，不能使用以前使用过的密码，可使用口令历史，这样oracle就会将口令修改的信息存放到数据字典中，这样当用户修改密码时，oracle就会对新旧密码进行比较，当发现新旧密码一样时，就提示用户重新输入密码。<br>例子：<br>1）建立profile<br>SQL&gt;create profile password_history limit password_life_time 10 password_grace_time 2<br>password_reuse_time 10 //password_reuse_time指定口令可重用时间即10天后就可以重用<br>2）分配给某个用户<br>SQL&gt; alter user test profile password_history;<br>删除profile:<br>SQL&gt; drop profile password_history 【casade】<br>注意：文件删除后，用这个文件去约束的那些用户通通也都被释放了。。<br>加了casade，就会把级联的相关东西也给删除掉   </p>
<h3 id="添加数据"><a href="#添加数据" class="headerlink" title="添加数据"></a><strong>添加数据</strong></h3><p>–所有字段都插入数据<br>insert into student values (‘a001’, ‘张三’, ‘男’, ‘01-5 月-05’, 10);<br>–oracle中默认的日期格式‘dd-mon-yy’ dd 天 mon 月份 yy 2位的年 ‘09-6 月-99’ 1999年6月9日<br>–修改日期的默认格式（临时修改，数据库重启后仍为默认；如要修改需要修改注册表）<br>alter session set nls_date_format =’yyyy-mm-dd’;<br>–修改后，可以用我们熟悉的格式添加日期类型：<br>insert into student values (‘a002’, ‘mike’, ‘男’, ‘1905-05-06’, 10);<br>–插入部分字段<br>insert into student(xh, xm, sex) values (‘a003’, ‘john’, ‘女’);<br>–插入空值<br>insert into student(xh, xm, sex, birthday) values (‘a004’, ‘martin’, ‘男’, null);<br>–问题来了，如果你要查询student表里birthday为null的记录，怎么写sql呢？<br>–错误写法：select <em> from student where birthday = null;<br>–正确写法：select </em> from student where birthday is null;<br>–如果要查询birthday不为null,则应该这样写：<br>select * from student where birthday is not null;   </p>
<h3 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a><strong>删除数据</strong></h3><p>delete from student; –删除所有记录，表结构还在，写日志，可以恢复的，速度慢。<br>–delete的数据可以恢复。<br>savepoint a; –创建保存点<br>delete from student;<br>rollback to a; –恢复到保存点<br>一个有经验的dba，在确保完成无误的情况下要定期创建还原点。    </p>
<h3 id="查看表结构"><a href="#查看表结构" class="headerlink" title="查看表结构"></a><strong>查看表结构</strong></h3><p>desc emp;</p>
<h3 id="查询所有列"><a href="#查询所有列" class="headerlink" title="查询所有列"></a><strong>查询所有列</strong></h3><p>select <em> from dept;<br>备注:切忌动不动就用`select </em><code>，使用</code>*`效率比较低，特别在大表中要注意。  </p>
<h3 id="打开显示操作时间的开关，在底部显示操作时间"><a href="#打开显示操作时间的开关，在底部显示操作时间" class="headerlink" title="打开显示操作时间的开关，在底部显示操作时间"></a><strong>打开显示操作时间的开关，在底部显示操作时间</strong></h3><p>set timing on/off;<br>eg、sql&gt; insert into tb_stu values(‘0001’, ‘zhangsan’, 24);<br>1 row inserted<br>executed in 0.015 seconds   </p>
<h3 id="添加主键约束"><a href="#添加主键约束" class="headerlink" title="添加主键约束"></a><strong>添加主键约束</strong></h3><p>alter table tb_dept add constraint tb_dept primary key (deptno);   </p>
<h3 id="统计"><a href="#统计" class="headerlink" title="统计"></a><strong>统计</strong></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">count</span> (*) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>
<h3 id="如何取消重复行distinct"><a href="#如何取消重复行distinct" class="headerlink" title="如何取消重复行distinct"></a><strong>如何取消重复行distinct</strong></h3><p>select distinct deptno, job from emp;   </p>
<h3 id="nvl函数"><a href="#nvl函数" class="headerlink" title="nvl函数"></a><strong>nvl函数</strong></h3><p>格式为：nvl(string1, replace_with) 　　<br>功能：如果string1为null，则nvl函数返回replace_with的值，否则返回string1的值。 　<br>注意事项：string1和replace_with必须为同一数据类型，除非显示的使用to_char函数。    　<br>eg、如何显示每个雇员的年工资？   </p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select sal*<span class="number">13</span>+nvl(comm, <span class="number">0</span>)*<span class="number">13</span> <span class="string">"年薪"</span> , ename, comm from emp;</span><br></pre></td></tr></table></figure>
<h3 id="如何处理null值"><a href="#如何处理null值" class="headerlink" title="如何处理null值"></a><strong>如何处理null值</strong></h3><p>使用nvl函数来处理</p>
<h3 id="如何连接字符串"><a href="#如何连接字符串" class="headerlink" title="如何连接字符串(||)"></a><strong>如何连接字符串(||)</strong></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename || <span class="string">' is a '</span> || job <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>
<h3 id="如何查找1982-1-1后入职的员工？"><a href="#如何查找1982-1-1后入职的员工？" class="headerlink" title="如何查找1982.1.1后入职的员工？"></a><strong>如何查找1982.1.1后入职的员工？</strong></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,hiredate <span class="keyword">from</span> emp <span class="keyword">where</span> hiredate &gt;<span class="string">'1-1 月-1982'</span>;</span><br></pre></td></tr></table></figure>
<h3 id="如何使用like操作符"><a href="#如何使用like操作符" class="headerlink" title="如何使用like操作符"></a><strong>如何使用like操作符</strong></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">%</span><span class="bash">：表示0到多个字符 _：表示任意单个字符</span></span><br></pre></td></tr></table></figure>
<h2 id="问题：如何显示首字符为s的员工姓名和工资？"><a href="#问题：如何显示首字符为s的员工姓名和工资？" class="headerlink" title="问题：如何显示首字符为s的员工姓名和工资？"></a><strong>问题：如何显示首字符为s的员工姓名和工资？</strong></h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,sal <span class="keyword">from</span> emp <span class="keyword">where</span> ename <span class="keyword">like</span> <span class="string">'s%'</span>;</span><br></pre></td></tr></table></figure>
<h2 id="如何显示第三个字符为大写o的所有员工的姓名和工资？"><a href="#如何显示第三个字符为大写o的所有员工的姓名和工资？" class="headerlink" title="如何显示第三个字符为大写o的所有员工的姓名和工资？"></a><strong>如何显示第三个字符为大写o的所有员工的姓名和工资？</strong></h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,sal <span class="keyword">from</span> emp <span class="keyword">where</span> ename <span class="keyword">like</span> <span class="string">'__o%'</span>;</span><br></pre></td></tr></table></figure>
<h2 id="如何显示empno为7844-7839-123-456的雇员情况？"><a href="#如何显示empno为7844-7839-123-456的雇员情况？" class="headerlink" title="如何显示empno为7844,7839,123,456的雇员情况？"></a><strong>如何显示empno为7844,7839,123,456的雇员情况？</strong></h2><p>select * from emp where empno in (7844, 7839, 123, 456);     </p>
<h2 id="如何显示没有上级的雇员的情况？"><a href="#如何显示没有上级的雇员的情况？" class="headerlink" title="如何显示没有上级的雇员的情况？"></a><strong>如何显示没有上级的雇员的情况？</strong></h2><p>错误写法：select <em> from emp where mgr = ‘’;<br>正确写法：select </em> from emp where mgr is null;<br>查询工资高于500或者是岗位为manager的雇员，同时还要满足他们的姓名首字母为大写的J？<br>select * from emp where (sal &gt; 500 or job = ‘MANAGER’) and ename like ‘J%’;<br>使用列的别名排序<br>问题：按年薪排序   </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename, (sal+nvl(comm,<span class="number">0</span>))*<span class="number">12</span> <span class="string">"年薪"</span> <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> <span class="string">"年薪"</span> <span class="keyword">asc</span>;</span><br></pre></td></tr></table></figure>
<p>备注：别名需要使用“”号圈中,英文不需要“”号  </p>
<h2 id="最高工资那个人是谁？"><a href="#最高工资那个人是谁？" class="headerlink" title="最高工资那个人是谁？"></a><strong>最高工资那个人是谁？</strong></h2><p>错误写法：select ename, sal from emp where sal=max(sal);<br>正确写法：select ename, sal from emp where sal=(select max(sal) from emp);<br>注意：select ename, max(sal) from emp;这语句执行的时候会报错，说ora-00937：非单组分组函数。因为max是分组函数，而ename不是分组函数…….<br>但是select min(sal), max(sal) from emp;这句是可以执行的。因为min和max都是分组函数，就是说：如果列里面有一个分组函数，其它的都必须是分组函数，否则就出错。这是语法规定的<br>group by 用于对查询的结果分组统计，<br>having 子句用于限制分组显示结果。   </p>
<h2 id="问题：如何显示每个部门的平均工资和最高工资？"><a href="#问题：如何显示每个部门的平均工资和最高工资？" class="headerlink" title="问题：如何显示每个部门的平均工资和最高工资？"></a><strong>问题：如何显示每个部门的平均工资和最高工资？</strong></h2><p>select avg(sal), max(sal), deptno from emp group by deptno;<br>（注意：这里暗藏了一点，如果你要分组查询的话，分组的字段deptno一定要出现在查询的列表里面，否则会报错。因为分组的字段都不出现的话，就没办法分组了）   </p>
<h2 id="问题：显示每个部门的每种岗位的平均工资和最低工资？"><a href="#问题：显示每个部门的每种岗位的平均工资和最低工资？" class="headerlink" title="问题：显示每个部门的每种岗位的平均工资和最低工资？"></a><strong>问题：显示每个部门的每种岗位的平均工资和最低工资？</strong></h2><p>select min(sal), avg(sal), deptno, job from emp group by deptno, job;   </p>
<h2 id="问题：显示平均工资低于2000的部门号和它的平均工资？"><a href="#问题：显示平均工资低于2000的部门号和它的平均工资？" class="headerlink" title="问题：显示平均工资低于2000的部门号和它的平均工资？"></a><strong>问题：显示平均工资低于2000的部门号和它的平均工资？</strong></h2><p>select avg(sal), max(sal), deptno from emp group by deptno having avg(sal)&lt; 2000;<br>如果在select语句中同时包含有group by, having, order by 那么它们的顺序是group by, having, order by  </p>
<h2 id="显示某个员工的上级领导的姓名？"><a href="#显示某个员工的上级领导的姓名？" class="headerlink" title="显示某个员工的上级领导的姓名？"></a><strong>显示某个员工的上级领导的姓名？</strong></h2><p>比如显示员工‘FORD’的上级<br>SELECT worker.ename, boss.ename FROM emp worker, emp boss WHERE worker.mgr = boss.empno AND worker.ename = ‘FORD’;   </p>
<h2 id="单行子查询"><a href="#单行子查询" class="headerlink" title="单行子查询"></a><strong>单行子查询</strong></h2><p>SELECT * FROM emp WHERE deptno = (select deptno from emp WHERE ename = ‘SMITH’);<br>数据库在执行sql是从左到右扫描的，如果有括号的话，括号里面的先被优先执行。  </p>
<h2 id="多行子查询"><a href="#多行子查询" class="headerlink" title="多行子查询"></a><strong>多行子查询</strong></h2><p>SELECT * FROM emp WHERE job IN (SELECT DISTINCT job FROM emp WHERE deptno = 10);<br>注意：不能用job=..，因为等号=是一对一的  </p>
<h2 id="如何显示工资比部门30的所有员工的工资高的员工的姓名、工资和部门号？"><a href="#如何显示工资比部门30的所有员工的工资高的员工的姓名、工资和部门号？" class="headerlink" title="如何显示工资比部门30的所有员工的工资高的员工的姓名、工资和部门号？"></a><strong>如何显示工资比部门30的所有员工的工资高的员工的姓名、工资和部门号？</strong></h2><p>–方法一<br>SELECT ename, sal, deptno FROM emp WHERE sal &gt; all(SELECT sal FROM emp WHERE deptno = 30);<br>–方法二(执行效率最高，使用聚合函数)<br>SELECT ename, sal, deptno FROM emp WHERE sal &gt; (SELECT max(sal) FROM emp WHERE deptno = 30);  </p>
<h2 id="如何显示工资比部门30的任意一个员工的工资高的员工姓名、工资和部门号？"><a href="#如何显示工资比部门30的任意一个员工的工资高的员工姓名、工资和部门号？" class="headerlink" title="如何显示工资比部门30的任意一个员工的工资高的员工姓名、工资和部门号？"></a><strong>如何显示工资比部门30的任意一个员工的工资高的员工姓名、工资和部门号？</strong></h2><p>–方法一<br>SELECT ename, sal, deptno FROM emp WHERE sal &gt; ANY (SELECT sal FROM emp WHERE deptno = 30);<br>–方法二(执行效率最高，使用聚合函数)<br>SELECT ename, sal, deptno FROM emp WHERE sal &gt; (SELECT min(sal) FROM emp WHERE deptno = 30);   </p>
<h2 id="多列子查询"><a href="#多列子查询" class="headerlink" title="多列子查询"></a><strong>多列子查询</strong></h2><h2 id="查询与SMITH-的部门和岗位完全相同的所有雇员"><a href="#查询与SMITH-的部门和岗位完全相同的所有雇员" class="headerlink" title="查询与SMITH 的部门和岗位完全相同的所有雇员"></a><strong>查询与SMITH 的部门和岗位完全相同的所有雇员</strong></h2><p>SELECT deptno, job FROM emp WHERE ename = ‘SMITH’;<br>SELECT * FROM emp WHERE (deptno, job) = (SELECT deptno, job FROM emp WHERE ename = ‘SMITH’);  </p>
<h2 id="如何显示高于自己部门平均工资的员工的信息"><a href="#如何显示高于自己部门平均工资的员工的信息" class="headerlink" title="如何显示高于自己部门平均工资的员工的信息"></a><strong>如何显示高于自己部门平均工资的员工的信息</strong></h2><p>SELECT e.ename, e.deptno, e.sal, ds.mysal<br>FROM emp e, (SELECT deptno, AVG(sal) mysal FROM emp GROUP by deptno) ds<br>WHERE e.deptno = ds.deptno AND e.sal &gt; ds.mysal;<br><strong>注意：</strong>给表取别名的时候，不能加as；但是给列取别名，是可以加as的  </p>
<h2 id="用查询结果创建新表"><a href="#用查询结果创建新表" class="headerlink" title="用查询结果创建新表"></a><strong>用查询结果创建新表</strong></h2><p>CREATE TABLE mytable (id, name, sal, job, deptno) as SELECT empno, ename, sal, job, deptno FROM emp;</p>
<h3 id="分页"><a href="#分页" class="headerlink" title="分页"></a><strong>分页</strong></h3><p>根据rowid来分<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">  FROM EMP</span><br><span class="line"> WHERE ROWID IN</span><br><span class="line">       (SELECT RID</span><br><span class="line">          FROM (SELECT ROWNUM RN, RID</span><br><span class="line">                  FROM (SELECT ROWID RID, EMPNO FROM EMP ORDER BY EMPNO DESC)</span><br><span class="line">                 WHERE ROWNUM &lt;= ( (currentPage-1) * pageSize + pageSize )) --每页显示几条</span><br><span class="line">         WHERE RN &gt; ((currentPage-1) * pageSize) ) --当前页数</span><br><span class="line"> ORDER BY EMPNO DESC;</span><br><span class="line"> </span><br><span class="line">eg、</span><br><span class="line">-- 5 = (currentPage-1) * pageSize + pageSize   每页显示几条</span><br><span class="line">-- 0 = (currentPage-1) * pageSize              当前页数</span><br><span class="line">SELECT *</span><br><span class="line">  FROM EMP</span><br><span class="line"> WHERE ROWID IN</span><br><span class="line">       (SELECT RID</span><br><span class="line">          FROM (SELECT ROWNUM RN, RID</span><br><span class="line">                  FROM (SELECT ROWID RID, EMPNO FROM EMP ORDER BY EMPNO DESC)</span><br><span class="line">                 WHERE ROWNUM &lt;= ( (1-1) * 5 + 5 )) --每页显示几条</span><br><span class="line">         WHERE RN &gt; ((1-1) * 5) ) --当前页数</span><br><span class="line"> ORDER BY EMPNO DESC;</span><br></pre></td></tr></table></figure></p>
<h2 id="事务"><a href="#事务" class="headerlink" title="事务"></a><strong>事务</strong></h2><p>设置只读事务: set transaction read only;</p>
<h3 id="导出表"><a href="#导出表" class="headerlink" title="导出表"></a><strong>导出表</strong></h3><p>在导入和导出的时候，要到oracle目录的bin目录下<br>C:\Users\jiqinlin&gt;cd D:\dev\oracle\product\10.2.0\db_1\bin<br>C:\Users\jiqinlin&gt;d:<br>D:\dev\oracle\product\10.2.0\db_1\bin&gt;exp userid=scott/oracle@orcl tables=(emp) file=d:\emp.dmp   </p>

            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls" data-autoplay="true">
                <source type="audio/mpeg" src="/music/1.mp3">
            </audio>
            
        </div>
        
    <div id="gitalk-container" class="comment link" data-ae="false" data-ci="55316b017b800ec5c0da" data-cs="fbe9f4aafee144a34ec283ca34c833ad6da91507" data-r="talk" data-o="viacbde" data-a="viabcde" data-d="false">查看评论</div>


    </div>
    
        <div class="side">
            <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#创建用户"><span class="toc-number">1.</span> <span class="toc-text">创建用户</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修改用户的密码"><span class="toc-number">2.</span> <span class="toc-text">修改用户的密码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#删除用户"><span class="toc-number">3.</span> <span class="toc-text">删除用户</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#权限"><span class="toc-number">4.</span> <span class="toc-text">权限</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#角色"><span class="toc-number">5.</span> <span class="toc-text">角色</span></a></li></ol><li class="toc-item toc-level-2"><a class="toc-link" href="#预定义角色connect、resource、dba"><span class="toc-number"></span> <span class="toc-text">预定义角色connect、resource、dba</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#自定义角色"><span class="toc-number"></span> <span class="toc-text">自定义角色</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#给角色授权"><span class="toc-number"></span> <span class="toc-text">给角色授权</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#分配角色给某个用户"><span class="toc-number"></span> <span class="toc-text">分配角色给某个用户</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#删除角色"><span class="toc-number"></span> <span class="toc-text">删除角色</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#显示角色信息"><span class="toc-number"></span> <span class="toc-text">显示角色信息</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#用户管理案例"><span class="toc-number">1.</span> <span class="toc-text">用户管理案例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#with-admin-option与with-grant-option区别"><span class="toc-number">2.</span> <span class="toc-text">with admin option与with grant option区别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#账户锁定"><span class="toc-number">3.</span> <span class="toc-text">账户锁定</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#添加数据"><span class="toc-number">4.</span> <span class="toc-text">添加数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#删除数据"><span class="toc-number">5.</span> <span class="toc-text">删除数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查看表结构"><span class="toc-number">6.</span> <span class="toc-text">查看表结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查询所有列"><span class="toc-number">7.</span> <span class="toc-text">查询所有列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#打开显示操作时间的开关，在底部显示操作时间"><span class="toc-number">8.</span> <span class="toc-text">打开显示操作时间的开关，在底部显示操作时间</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#添加主键约束"><span class="toc-number">9.</span> <span class="toc-text">添加主键约束</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#统计"><span class="toc-number">10.</span> <span class="toc-text">统计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#如何取消重复行distinct"><span class="toc-number">11.</span> <span class="toc-text">如何取消重复行distinct</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#nvl函数"><span class="toc-number">12.</span> <span class="toc-text">nvl函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#如何处理null值"><span class="toc-number">13.</span> <span class="toc-text">如何处理null值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#如何连接字符串"><span class="toc-number">14.</span> <span class="toc-text">如何连接字符串(||)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#如何查找1982-1-1后入职的员工？"><span class="toc-number">15.</span> <span class="toc-text">如何查找1982.1.1后入职的员工？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#如何使用like操作符"><span class="toc-number">16.</span> <span class="toc-text">如何使用like操作符</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#问题：如何显示首字符为s的员工姓名和工资？"><span class="toc-number"></span> <span class="toc-text">问题：如何显示首字符为s的员工姓名和工资？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#如何显示第三个字符为大写o的所有员工的姓名和工资？"><span class="toc-number"></span> <span class="toc-text">如何显示第三个字符为大写o的所有员工的姓名和工资？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#如何显示empno为7844-7839-123-456的雇员情况？"><span class="toc-number"></span> <span class="toc-text">如何显示empno为7844,7839,123,456的雇员情况？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#如何显示没有上级的雇员的情况？"><span class="toc-number"></span> <span class="toc-text">如何显示没有上级的雇员的情况？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#最高工资那个人是谁？"><span class="toc-number"></span> <span class="toc-text">最高工资那个人是谁？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#问题：如何显示每个部门的平均工资和最高工资？"><span class="toc-number"></span> <span class="toc-text">问题：如何显示每个部门的平均工资和最高工资？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#问题：显示每个部门的每种岗位的平均工资和最低工资？"><span class="toc-number"></span> <span class="toc-text">问题：显示每个部门的每种岗位的平均工资和最低工资？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#问题：显示平均工资低于2000的部门号和它的平均工资？"><span class="toc-number"></span> <span class="toc-text">问题：显示平均工资低于2000的部门号和它的平均工资？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#显示某个员工的上级领导的姓名？"><span class="toc-number"></span> <span class="toc-text">显示某个员工的上级领导的姓名？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#单行子查询"><span class="toc-number"></span> <span class="toc-text">单行子查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#多行子查询"><span class="toc-number"></span> <span class="toc-text">多行子查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#如何显示工资比部门30的所有员工的工资高的员工的姓名、工资和部门号？"><span class="toc-number"></span> <span class="toc-text">如何显示工资比部门30的所有员工的工资高的员工的姓名、工资和部门号？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#如何显示工资比部门30的任意一个员工的工资高的员工姓名、工资和部门号？"><span class="toc-number"></span> <span class="toc-text">如何显示工资比部门30的任意一个员工的工资高的员工姓名、工资和部门号？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#多列子查询"><span class="toc-number"></span> <span class="toc-text">多列子查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#查询与SMITH-的部门和岗位完全相同的所有雇员"><span class="toc-number"></span> <span class="toc-text">查询与SMITH 的部门和岗位完全相同的所有雇员</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#如何显示高于自己部门平均工资的员工的信息"><span class="toc-number"></span> <span class="toc-text">如何显示高于自己部门平均工资的员工的信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#用查询结果创建新表"><span class="toc-number"></span> <span class="toc-text">用查询结果创建新表</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#分页"><span class="toc-number">1.</span> <span class="toc-text">分页</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#事务"><span class="toc-number"></span> <span class="toc-text">事务</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#导出表"><span class="toc-number">1.</span> <span class="toc-text">导出表</span></a></li></ol>
        </li></div>
    
</div>


    </div>
</div>
<script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body>
<script src="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script src="//lib.baomitu.com/jquery/1.8.3/jquery.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/diaspora.js"></script>
<link rel="stylesheet" href="/photoswipe/photoswipe.css">
<link rel="stylesheet" href="/photoswipe/default-skin/default-skin.css">
<script src="/photoswipe/photoswipe.min.js"></script>
<script src="/photoswipe/photoswipe-ui-default.min.js"></script>

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>




</html>