
<!DOCTYPE html>
<html lang="" class="loading">
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>廖锡洪</title>

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate">
    <meta name="keywords" content="viabcde,"> 
    
    <meta name="author" content="viacbde"> 
    <link rel="alternative" href="atom.xml" title="廖锡洪" type="application/atom+xml"> 
    <link rel="icon" href="/img/favicon.png"> 
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
    <link rel="stylesheet" href="/css/diaspora.css">
</head>
</html>
<body class="loading">
    <div id="loader"></div>
    <div id="single">
    <div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <a class="icon-home image-icon" href="javascript:;"></a>
    <div title="播放/暂停" class="icon-play"></div>
    <h3 class="subtitle">SpringBoot核心组件</h3>
    <div class="social">
        <!--<div class="like-icon">-->
            <!--<a href="javascript:;" class="likeThis active"><span class="icon-like"></span><span class="count">76</span></a>-->
        <!--</div>-->
        <div>
            <div class="share">
                <a title="获取二维码" class="icon-scan" href="javascript:;"></a>
            </div>
            <div id="qr"></div>
        </div>
    </div>
    <div class="scrollbar"></div>
</div>
    <div class="section">
        <div class="article">
    <div class="main">
        <h1 class="title">SpringBoot核心组件</h1>
        <div class="stuff">
            <span>十一月 14, 2018</span>
            
  <ul class="post-tags-list"><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/SpringBoot/">SpringBoot</a><span class="post-tags-list-count">17</span></li><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/标签/">标签</a><span class="post-tags-list-count">162</span></li></ul>


        </div>
        <div class="content markdown">
            <h3 id="核心组件starter"><a href="#核心组件starter" class="headerlink" title="核心组件starter"></a><strong>核心组件starter</strong></h3><p>Starter主要用来简化依赖用的。比如我们之前做 MVC时要引入日志组件，那么需要去找到log4j的版本，然后引入，现在有了Starter之后，直接用这个之后，log4j就自动引入了，也不用关心版本这些问题。  </p>
<h3 id="核心组件actuator"><a href="#核心组件actuator" class="headerlink" title="核心组件actuator"></a><strong>核心组件actuator</strong></h3><p>即<strong>spring-boot-starter-actuator</strong>，主要作用是<strong>监控与管理</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure></p>
<p><strong>模块解析</strong><br><strong>包含以下三个类：</strong><br><strong>应用配置类：</strong>应用配置、环境变量、自动化配置报告等<br><strong>度量指标类：</strong>内存信息、线程池信息、HTTP请求统计等<br><strong>操作控制类：</strong>提供了对应用的关闭等操作类功能  </p>
<h1 id="应用配置类"><a href="#应用配置类" class="headerlink" title="应用配置类"></a><strong>应用配置类</strong></h1><h2 id="autoconfig"><a href="#autoconfig" class="headerlink" title="/autoconfig"></a><strong>/autoconfig</strong></h2><p><strong>使用场景：</strong>帮助找到自动化配置为什么没有生效的具体原因。<br><strong>该报告内容将自动化配置内容分为两部分：</strong><br>positiveMatches中返回的是条件匹配成功的自动化配置<br>negativeMatches中返回的是条件匹配不成功的自动化配置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;positiveMatches&quot;: &#123; // 条件匹配成功的</span><br><span class="line">        &quot;EndpointWebMvcAutoConfiguration&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">                &quot;condition&quot;: &quot;OnClassCondition&quot;,</span><br><span class="line">                &quot;message&quot;: &quot;@ConditionalOnClass classes found: javax.servlet.Servlet,org.springframework.web.servlet.DispatcherServlet&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                &quot;condition&quot;: &quot;OnWebApplicationCondition&quot;,</span><br><span class="line">                &quot;message&quot;: &quot;found web application StandardServletEnvironment&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        ],</span><br><span class="line">        ...</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;negativeMatches&quot;: &#123;  // 条件不匹配成功的</span><br><span class="line">        &quot;HealthIndicatorAutoConfiguration.DataSourcesHealthIndicatorConfiguration&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">                &quot;condition&quot;: &quot;OnClassCondition&quot;,</span><br><span class="line">                &quot;message&quot;: &quot;required @ConditionalOnClass classes not found: org.springframework.jdbc.core.JdbcTemplate&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        ],</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>每个自动化配置候选项中都有一系列的条件，比如上面没有成功匹配的HealthIndicatorAutoConfiguration.DataSourcesHealthIndicatorConfiguration配置。<br>它的先决条件就是需要在工程中包含org.springframework.jdbc.core.JdbcTemplate类，由于没有引入相关的依赖，它就不会执行自动化配置内容。  所以，当发现有一些配置没有生效时，就可以通过该端点来查看没有生效的原因。    </p>
<h2 id="beans"><a href="#beans" class="headerlink" title="/beans"></a><strong>/beans</strong></h2><p><strong>作用：</strong>该端点用来获取应用上下文中创建的所有Bean  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;context&quot;: &quot;hello:dev:8881&quot;,</span><br><span class="line">        &quot;parent&quot;: null,</span><br><span class="line">        &quot;beans&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">                &quot;bean&quot;: &quot;org.springframework.boot.autoconfigure.web.DispatcherServletAutoConfiguration$DispatcherServletConfiguration&quot;,</span><br><span class="line">                &quot;scope&quot;: &quot;singleton&quot;,</span><br><span class="line">                &quot;type&quot;: &quot;org.springframework.boot.autoconfigure.web.DispatcherServletAutoConfiguration$DispatcherServletConfiguration$$EnhancerBySpringCGLIB$$3440282b&quot;,</span><br><span class="line">                &quot;resource&quot;: &quot;null&quot;,</span><br><span class="line">                &quot;dependencies&quot;: [</span><br><span class="line">                    &quot;serverProperties&quot;,</span><br><span class="line">                    &quot;spring.mvc.CONFIGURATION_PROPERTIES&quot;,</span><br><span class="line">                    &quot;multipartConfigElement&quot;</span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                &quot;bean&quot;: &quot;dispatcherServlet&quot;,</span><br><span class="line">                &quot;scope&quot;: &quot;singleton&quot;,</span><br><span class="line">                &quot;type&quot;: &quot;org.springframework.web.servlet.DispatcherServlet&quot;,</span><br><span class="line">                &quot;resource&quot;: &quot;class path resource [org/springframework/boot/autoconfigure/web/DispatcherServletAutoConfiguration$DispatcherServletConfiguration.class]&quot;,</span><br><span class="line">                &quot;dependencies&quot;: []</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>如上示例中，可以看到每个bean都包含了下面这几个信息：<br>bean：Bean的名称<br>scope：Bean的作用域<br>type：Bean的Java类型<br>reource：class文件的具体路径<br>dependencies：依赖的Bean名称  </p>
<h3 id="configprops"><a href="#configprops" class="headerlink" title="/configprops"></a><strong>/configprops</strong></h3><p><strong>作用：</strong>用来获取应用中配置的属性信息报告。<br>从下面该端点返回示例片段中，返回了关于该短信的配置信息：<br>prefix属性代表了属性的配置前缀<br>properties代表了各个属性的名称和值<br>所以，我们可以通过该报告来看到各个属性的配置路径，比如我们要关闭该端点，就可以通过使用endpoints.configprops.enabled=false来完成设置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;configurationPropertiesReportEndpoint&quot;: &#123;</span><br><span class="line">        &quot;prefix&quot;: &quot;endpoints.configprops&quot;,</span><br><span class="line">        &quot;properties&quot;: &#123;</span><br><span class="line">            &quot;id&quot;: &quot;configprops&quot;,</span><br><span class="line">            &quot;sensitive&quot;: true,</span><br><span class="line">            &quot;enabled&quot;: true</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="env"><a href="#env" class="headerlink" title="/env"></a><strong>/env</strong></h3><p><strong>作用：</strong>该端点与/configprops不同，它用来获取应用所有可用的环境属性报告。包括：环境变量、JVM属性、应用的配置配置、命令行中的参数<br>从下面该端点返回的示例片段中，可以看到它不仅返回了应用的配置属性，还返回了系统属性、环境变量等丰富的配置信息，其中也包括了应用还没有没有使用的配置。<br><strong>用途：</strong>帮助看当前应用可以加载的配置信息，并配合@ConfigurationProperties将它们引入到应用来使用。<br>为了配置属性的安全，对于一些类似密码等敏感信息，该端点都会进行隐私保护，但是需要让属性名中包含：password、secret、key这些关键词，这样该端点在返回它们的时候会使用” *  “来替代实际的属性值<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;profiles&quot;: [</span><br><span class="line">        &quot;dev&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;server.ports&quot;: &#123;</span><br><span class="line">        &quot;local.server.port&quot;: 8881</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;servletContextInitParams&quot;: &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;systemProperties&quot;: &#123;</span><br><span class="line">        &quot;idea.version&quot;: &quot;2016.1.3&quot;,</span><br><span class="line">        &quot;java.runtime.name&quot;: &quot;Java(TM) SE Runtime Environment&quot;,</span><br><span class="line">        &quot;sun.boot.library.path&quot;: &quot;C:\\Program Files\\Java\\jdk1.8.0_91\\jre\\bin&quot;,</span><br><span class="line">        &quot;java.vm.version&quot;: &quot;25.91-b15&quot;,</span><br><span class="line">        &quot;java.vm.vendor&quot;: &quot;Oracle Corporation&quot;,</span><br><span class="line">        ...</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;systemEnvironment&quot;: &#123;</span><br><span class="line">        &quot;configsetroot&quot;: &quot;C:\\WINDOWS\\ConfigSetRoot&quot;,</span><br><span class="line">        &quot;RABBITMQ_BASE&quot;: &quot;E:\\tools\\rabbitmq&quot;,</span><br><span class="line">        ...</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;applicationConfig: [classpath:/application-dev.properties]&quot;: &#123;</span><br><span class="line">        &quot;server.port&quot;: &quot;8881&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;applicationConfig: [classpath:/application.properties]&quot;: &#123;</span><br><span class="line">        &quot;server.port&quot;: &quot;8885&quot;,</span><br><span class="line">        &quot;spring.profiles.active&quot;: &quot;dev&quot;,</span><br><span class="line">        &quot;info.app.name&quot;: &quot;spring-boot-hello&quot;,</span><br><span class="line">        &quot;info.app.version&quot;: &quot;v1.0.0&quot;,</span><br><span class="line">        &quot;spring.application.name&quot;: &quot;hello&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="mappings"><a href="#mappings" class="headerlink" title="/mappings"></a><strong>/mappings</strong></h3><p><strong>作用：</strong>该端点用来返回所有Spring MVC的控制器映射关系报告<br>从下面的示例片段中，可以看该报告的信息<br>与我们在启用Spring MVC的Web应用时输出的日志信息类似，其中bean属性标识了该映射关系的请求处理器，method属性标识了该映射关系的具体处理类和处理函数  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;/webjars/**&quot;: &#123;</span><br><span class="line">        &quot;bean&quot;: &quot;resourceHandlerMapping&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;/**&quot;: &#123;</span><br><span class="line">        &quot;bean&quot;: &quot;resourceHandlerMapping&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;/**/favicon.ico&quot;: &#123;</span><br><span class="line">        &quot;bean&quot;: &quot;faviconHandlerMapping&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;&#123;[/hello]&#125;&quot;: &#123;</span><br><span class="line">        &quot;bean&quot;: &quot;requestMappingHandlerMapping&quot;,</span><br><span class="line">        &quot;method&quot;: &quot;public java.lang.String com.didispace.web.HelloController.index()&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;&#123;[/mappings || /mappings.json],methods=[GET],produces=[application/json]&#125;&quot;: &#123;</span><br><span class="line">        &quot;bean&quot;: &quot;endpointHandlerMapping&quot;,</span><br><span class="line">        &quot;method&quot;: &quot;public java.lang.Object org.springframework.boot.actuate.endpoint.mvc.EndpointMvcAdapter.invoke()&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="info"><a href="#info" class="headerlink" title="/info"></a><strong>/info</strong></h3><p><strong>作用：</strong>用来返回应用自定义的信息。默认情况下，该端点只会返回一个空的json内容。我们可以在application.properties配置文件中通过info前缀来设置一些属性，比如下面这样：  </p>
<p>info.app.name=spring-boot-hello<br>info.app.version=v1.0.0<br>再访问/info端点，我们可以得到下面的返回报告，其中就包含了上面我们在应用自定义的两个参数。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;app&quot;: &#123;</span><br><span class="line">        &quot;name&quot;: &quot;spring-boot-hello&quot;,</span><br><span class="line">        &quot;version&quot;: &quot;v1.0.0&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="度量指标类"><a href="#度量指标类" class="headerlink" title="度量指标类"></a><strong>度量指标类</strong></h2><p>应用配置类端点所提供的信息报告在应用启动时都已经确定了其返回内容，是一个静态报告。<br>而度量指标类端点提供的报告内容则是动态变化的，这些端点提供了应用程序运行中的信息<br>比如：内存使用情况、HTTP请求统计、外部资源指标等。<br>这些端点对于我们构建微服务架构中的监控系统非常有帮助，由于Spring Boot应用自身实现了这些端点，所以可以利用它们来收集想要的信息，以制定出各种自动化策略。    </p>
<h3 id="metrics"><a href="#metrics" class="headerlink" title="/metrics"></a><strong>/metrics</strong></h3><p><strong>作用：</strong>该端点用来返回当前应用的比如：内存信息、线程信息、垃圾回收信息等<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;mem&quot;: 541305,</span><br><span class="line">  &quot;mem.free&quot;: 317864,</span><br><span class="line">  &quot;processors&quot;: 8,</span><br><span class="line">  &quot;instance.uptime&quot;: 33376471,</span><br><span class="line">  &quot;uptime&quot;: 33385352,</span><br><span class="line">  &quot;systemload.average&quot;: -1,</span><br><span class="line">  &quot;heap.committed&quot;: 476672,</span><br><span class="line">  &quot;heap.init&quot;: 262144,</span><br><span class="line">  &quot;heap.used&quot;: 158807,</span><br><span class="line">  &quot;heap&quot;: 3701248,</span><br><span class="line">  &quot;nonheap.committed&quot;: 65856,</span><br><span class="line">  &quot;nonheap.init&quot;: 2496,</span><br><span class="line">  &quot;nonheap.used&quot;: 64633,</span><br><span class="line">  &quot;nonheap&quot;: 0,</span><br><span class="line">  &quot;threads.peak&quot;: 22,</span><br><span class="line">  &quot;threads.daemon&quot;: 20,</span><br><span class="line">  &quot;threads.totalStarted&quot;: 26,</span><br><span class="line">  &quot;threads&quot;: 22,</span><br><span class="line">  &quot;classes&quot;: 7669,</span><br><span class="line">  &quot;classes.loaded&quot;: 7669,</span><br><span class="line">  &quot;classes.unloaded&quot;: 0,</span><br><span class="line">  &quot;gc.ps_scavenge.count&quot;: 7,</span><br><span class="line">  &quot;gc.ps_scavenge.time&quot;: 118,</span><br><span class="line">  &quot;gc.ps_marksweep.count&quot;: 2,</span><br><span class="line">  &quot;gc.ps_marksweep.time&quot;: 234,</span><br><span class="line">  &quot;httpsessions.max&quot;: -1,</span><br><span class="line">  &quot;httpsessions.active&quot;: 0,</span><br><span class="line">  &quot;gauge.response.beans&quot;: 55,</span><br><span class="line">  &quot;gauge.response.env&quot;: 10,</span><br><span class="line">  &quot;gauge.response.hello&quot;: 5,</span><br><span class="line">  &quot;gauge.response.metrics&quot;: 4,</span><br><span class="line">  &quot;gauge.response.configprops&quot;: 153,</span><br><span class="line">  &quot;gauge.response.star-star&quot;: 5,</span><br><span class="line">  &quot;counter.status.200.beans&quot;: 1,</span><br><span class="line">  &quot;counter.status.200.metrics&quot;: 3,</span><br><span class="line">  &quot;counter.status.200.configprops&quot;: 1,</span><br><span class="line">  &quot;counter.status.404.star-star&quot;: 2,</span><br><span class="line">  &quot;counter.status.200.hello&quot;: 11,</span><br><span class="line">  &quot;counter.status.200.env&quot;: 1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>从上面的示例中，有这些重要的度量值：<br>系统信息：包括处理器数量processors、运行时间uptime和instance.uptime、系统平均负载systemload.average<br>mem. <em> ：内存概要信息，包括分配给应用的总内存数量以及当前空闲的内存数量。这些信息来自java.lang.Runtime<br>heap.</em> ：堆内存使用情况。来自java.lang.management.MemoryMXBean接口中getHeapMemoryUsage方法获取的java.lang.management.MemoryUsage。<br>nonheap.<em> ：非堆内存使用情况。来自java.lang.management.MemoryMXBean接口中getNonHeapMemoryUsage方法获取的java.lang.management.MemoryUsage。<br>threads.</em> ： 线程使用情况，包括线程数、守护线程数（daemon）、线程峰值（peak）等，这些数据均来自java.lang.management.ThreadMXBean。<br>classes.<em> ：应用加载和卸载的类统计。这些数据均来自java.lang.management.ClassLoadingMXBean。<br>gc.</em> ：垃圾收集器的详细信息，包括垃圾回收次数gc.ps_scavenge.count、垃圾回收消耗时间gc.ps_scavenge.time、标记-清除算法的次数gc.ps_marksweep.count、标记-清除算法的消耗时间gc.ps_marksweep.time。这些数据均来自java.lang.management.GarbageCollectorMXBean。<br>httpsessions.<em> ：Tomcat容器的会话使用情况。包括最大会话数httpsessions.max和活跃会话数httpsessions.active。该度量指标信息仅在引入了嵌入式Tomcat作为应用容器的时候才会提供。<br>gauge.</em> ：HTTP请求的性能指标之一，它主要用来反映一个绝对数值。比如上面示例中的gauge.response.hello: 5，它表示上一次hello请求的延迟时间为5毫秒。<br>counter.<em> ：HTTP请求的性能指标之一，它主要作为计数器来使用，记录了增加量和减少量。如上示例中counter.status.200.hello: 11，它代表了hello请求返回200状态的次数为11。<br>对于gauge.</em> 和counter.* 的统计，这里有一个特殊的内容请求star-star，它代表了对静态资源的访问。这两类度量指标非常有用，我们不仅可以使用它默认的统计指标，还可以在程序中轻松的增加自定义统计值。只需要通过注入org.springframework.boot.actuate.metrics.CounterService和org.springframework.boot.actuate.metrics.GaugeService来实现自定义的统计指标信息。比如：我们可以像下面这样自定义实现对hello接口的访问次数统计。    </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">@RestController</span><br><span class="line">public class HelloController &#123;</span><br><span class="line">    </span><br><span class="line">    @Autowired</span><br><span class="line">    private CounterService counterService;</span><br><span class="line"></span><br><span class="line">    @RequestMapping(&quot;/hello&quot;)</span><br><span class="line">    public String greet() &#123;</span><br><span class="line">        counterService.increment(&quot;didispace.hello.count&quot;);</span><br><span class="line">        return &quot;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="metrics-1"><a href="#metrics-1" class="headerlink" title="/metrics"></a><strong>/metrics</strong></h3><p><strong>作用：</strong>提供应用运行状态的完整度量指标报告，对于监控系统中的各项监控功能，它们的监控内容、数据收集频率都不同，如果我们每次都通过全量获取报告的方式来收集，略显粗暴。所以，我们还可以通过/metrics/{name}接口来更细粒度的获取度量信息，比如我们可以通过访问/metrics/mem.free来获取当前可用内存数量。  </p>
<h3 id="health"><a href="#health" class="headerlink" title="/health"></a><strong>/health</strong></h3><p>用来获取应用的各类健康指标信息。<br>在spring-boot-starter-actuator模块中自带实现了一些常用资源的健康指标检测器。这些检测器通过HealthIndicator接口实现，并且会根据依赖关系的引入实现自动化装配，比如用于检测磁盘的DiskSpaceHealthIndicator、检测DataSource连接是否可用的DataSourceHealthIndicator等。有时候，我们可能还会用到一些Spring Boot的Starter POMs中还没有封装的产品来进行开发，比如：当使用RocketMQ作为消息代理时，由于没有自动化配置的检测器，所以需要自己来实现一个用来采集健康信息的检测器。比如，我们可以在Spring Boot的应用中，为org.springframework.boot.actuate.health.HealthIndicator接口实现一个对RocketMQ的检测器类：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">@Component</span><br><span class="line">public class RocketMQHealthIndicator implements HealthIndicator &#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public Health health() &#123;</span><br><span class="line">        int errorCode = check();</span><br><span class="line">        if (errorCode != 0) &#123;</span><br><span class="line">          return Health.down().withDetail(&quot;Error Code&quot;, errorCode).build();</span><br><span class="line">        &#125;</span><br><span class="line">        return Health.up().build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  	private int check() &#123;</span><br><span class="line">     	// 对监控对象的检测操作</span><br><span class="line">  	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过重写health()函数来实现健康检查，返回的Heath对象中，共有两项内容，一个是状态信息，除了该示例中的UP与DOWN之外，还有UNKNOWN和OUT_OF_SERVICE，可以根据需要来实现返回；还有一个详细信息，采用Map的方式存储，在这里通过withDetail函数，注入了一个Error Code信息，也可以填入一下其他信息，比如，检测对象的IP地址、端口等。重新启动应用，并访问/health接口，我们在返回的JSON字符串中，将会包含了如下信息：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;rocketMQ&quot;: &#123;</span><br><span class="line">  &quot;status&quot;: &quot;UP&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="dump"><a href="#dump" class="headerlink" title="/dump"></a><strong>/dump</strong></h3><p>用来暴露程序运行中的线程信息。它使用java.lang.management.ThreadMXBean的dumpAllThreads方法来返回所有含有同步信息的活动线程详情。  </p>
<h3 id="trace"><a href="#trace" class="headerlink" title="/trace"></a><strong>/trace</strong></h3><p>用来返回基本的HTTP跟踪信息。默认情况下，跟踪信息的存储采用org.springframework.boot.actuate.trace.InMemoryTraceRepository实现的内存方式，始终保留最近的100条请求记录。它记录的内容格式如下：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;timestamp&quot;: 1482570022463,</span><br><span class="line">        &quot;info&quot;: &#123;</span><br><span class="line">            &quot;method&quot;: &quot;GET&quot;,</span><br><span class="line">            &quot;path&quot;: &quot;/metrics/mem&quot;,</span><br><span class="line">            &quot;headers&quot;: &#123;</span><br><span class="line">                &quot;request&quot;: &#123;</span><br><span class="line">                    &quot;host&quot;: &quot;localhost:8881&quot;,</span><br><span class="line">                    &quot;connection&quot;: &quot;keep-alive&quot;,</span><br><span class="line">                    &quot;cache-control&quot;: &quot;no-cache&quot;,</span><br><span class="line">                    &quot;user-agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36&quot;,</span><br><span class="line">                    &quot;postman-token&quot;: &quot;9817ea4d-ad9d-b2fc-7685-9dff1a1bc193&quot;,</span><br><span class="line">                    &quot;accept&quot;: &quot;*/*&quot;,</span><br><span class="line">                    &quot;accept-encoding&quot;: &quot;gzip, deflate, sdch&quot;,</span><br><span class="line">                    &quot;accept-language&quot;: &quot;zh-CN,zh;q=0.8&quot;</span><br><span class="line">                &#125;,</span><br><span class="line">                &quot;response&quot;: &#123;</span><br><span class="line">                    &quot;X-Application-Context&quot;: &quot;hello:dev:8881&quot;,</span><br><span class="line">                    &quot;Content-Type&quot;: &quot;application/json;charset=UTF-8&quot;,</span><br><span class="line">                    &quot;Transfer-Encoding&quot;: &quot;chunked&quot;,</span><br><span class="line">                    &quot;Date&quot;: &quot;Sat, 24 Dec 2016 09:00:22 GMT&quot;,</span><br><span class="line">                    &quot;status&quot;: &quot;200&quot;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    ...</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h2 id="操作控制类"><a href="#操作控制类" class="headerlink" title="操作控制类"></a><strong>操作控制类</strong></h2><p>由于介绍的所有端点都是用来反映应用自身的属性或是运行中的状态，相对于操作控制类端点没有那么敏感，所以他们默认都是启用的。<br>而操作控制类端点拥有更强大的控制能力，如果要使用它们的话，需要通过属性来配置开启。<br>在原生端点中，只提供了一个用来关闭应用的端点：/shutdown。我们可以通过如下配置开启它：<br>endpoints.shutdown.enabled=true<br>在配置了上述属性后，只需要访问应用的/shutdown端点就能实现关闭该应用的远程操作。由于开放关闭应用的操作本身是一件非常危险的事，所以真正在线上使用的时候，我们需要对其加入一定的保护机制，比如：定制Actuator的端点路径、整合Spring Security进行安全校验等。</p>

            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls" data-autoplay="true">
                <source type="audio/mpeg" src="/music/1.mp3">
            </audio>
            
        </div>
        
    <div id="gitalk-container" class="comment link" data-ae="false" data-ci="55316b017b800ec5c0da" data-cs="fbe9f4aafee144a34ec283ca34c833ad6da91507" data-r="talk" data-o="viacbde" data-a="viabcde" data-d="false">查看评论</div>


    </div>
    
        <div class="side">
            <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#核心组件starter"><span class="toc-number">1.</span> <span class="toc-text">核心组件starter</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#核心组件actuator"><span class="toc-number">2.</span> <span class="toc-text">核心组件actuator</span></a></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#应用配置类"><span class="toc-number"></span> <span class="toc-text">应用配置类</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#autoconfig"><span class="toc-number"></span> <span class="toc-text">/autoconfig</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#beans"><span class="toc-number"></span> <span class="toc-text">/beans</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#configprops"><span class="toc-number">1.</span> <span class="toc-text">/configprops</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#env"><span class="toc-number">2.</span> <span class="toc-text">/env</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mappings"><span class="toc-number">3.</span> <span class="toc-text">/mappings</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#info"><span class="toc-number">4.</span> <span class="toc-text">/info</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#度量指标类"><span class="toc-number"></span> <span class="toc-text">度量指标类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#metrics"><span class="toc-number">1.</span> <span class="toc-text">/metrics</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#metrics-1"><span class="toc-number">2.</span> <span class="toc-text">/metrics</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#health"><span class="toc-number">3.</span> <span class="toc-text">/health</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dump"><span class="toc-number">4.</span> <span class="toc-text">/dump</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#trace"><span class="toc-number">5.</span> <span class="toc-text">/trace</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#操作控制类"><span class="toc-number"></span> <span class="toc-text">操作控制类</span></a>
        </li></ol></li></div>
    
</div>


    </div>
</div>
<script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body>
<script src="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script src="//lib.baomitu.com/jquery/1.8.3/jquery.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/diaspora.js"></script>
<link rel="stylesheet" href="/photoswipe/photoswipe.css">
<link rel="stylesheet" href="/photoswipe/default-skin/default-skin.css">
<script src="/photoswipe/photoswipe.min.js"></script>
<script src="/photoswipe/photoswipe-ui-default.min.js"></script>

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>




</html>